{% extends "homebase.html" %}
{% load static %}
{% block content %}

<div class="modal-body">
    <h3 class="text-center text-success mt-3">Edit Book</h3>
    <div class="container bg-light p-4">
        <form class="was-validated" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="row">
                <div class="col col-6">
                    <label>Publisher</label>
                    {{form.publisher}}
                </div>
                <div class="col col-6">
                    <label>Writer</label>
                    {{form.writer}}
                </div>
            </div>
            <div class="row mt-2">
                  <div class="col-md-6">
                    <label class="form-label">Name</label>
                    <input type="text" class="form-control" name="name" placeholder="Please Name" \
                           value="{{form.name.value}}" required maxlength="120">
                    <span class="form-text">
                        Must be 120 characters long.
                    </span>
                  </div>
                <div class="col col-6">
                    <label class="form-label">Subject</label>
                    <input type="text" class="form-control" name="subject" placeholder="Please Subject" \
                           value="{{form.subject.value}}" required>
                    <span class="form-text">
                        Must be 120 characters long.
                    </span>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col col-6">
                    <label class="form-label">Count</label>
                    <input type="number" class="form-control" name="count" placeholder="Please Count" \
                           value="{{form.count.value}}">
                </div>
                <div class="col col-6">
                    <label class="form-label">Page Count</label>
                    <input type="text" class="form-control" name="page_count" placeholder="Please Page Count" \
                           value="{{form.page_count.value}}">
                </div>
            </div>
            <div class="row mt-2">
                <div class="col col-6">
                    <label class="form-label">ISBN</label>
                    <input class="form-control" name="isbn" placeholder="Please ISBN" \
                           required value="{{form.isbn.value}}">
                </div>
                <div class="col col-6">
                    <label class="form-label" name="publisher_date">Publisher Date</label>
                    {{form.publisher_date}}
                </div>
            </div>
            <div class="row mt-2">
                <div class="col col-12">
                    <label class="form-label">Description</label>
                    <div>{{form.description}}</div>
                </div>
            </div>
            <div class="container d-flex justify-content-center">
                <button class="btn btn-success me-2" type="submit">Save</button>
                <button class="btn btn-secondary" onclick="location.href='{% url 'books' %}'">Back</button>
            </div>
        </form>
    </div>
</div>

<script type="text/javascript">
    function get_writers() {
       id = document.getElementById("publisher_id").value;
       $.ajax({
        type: "GET",
        url:  "{% url 'publisher_of_writers' %}",
        data: {'publisher_id': id},
        success: function(data) {
                let html_data = '<option value="">---------</option>';
                data.forEach(function (writer) {
                    html_data += `<option value="${writer.id}">${writer.name}</option>`
                });
                $("#writer_id").html(html_data);
        },
        error: function() {
            alert('Error occurred');
        }
       });
    }
</script>
{% endblock %}

