{% extends "homebase.html" %}
{% block content %}
<div class="modal-body">
    <h3 class="text-center text-success mt-3">Add Book</h3>
    <form method="post" action="{% url 'add_book' %}" class="add-book-form" novalidate>
      {% csrf_token %}
      <div class="modal-body">
          {% csrf_token %}
          <div class="row">
              <div class="col col-6">
                  <label>Publisher</label>
                  {{form.publisher}}
                  <span class="form-text">{{ form.publisher.help_text|safe }}</span><br>
                  {% for error in form.publisher.errors %}
                    <span class="text-danger ml-2">{{ error|safe }}</span><br>
                  {% endfor %}
              </div>
              <div class="col col-6">
                  <label>Writer</label>
                  {{form.writer}}
                  <span class="form-text">{{ form.writer.help_text|safe }}</span><br>
                  {% for error in form.writer.errors %}
                    <span class="text-danger ml-2">{{ error|safe }}</span><br>
                  {% endfor %}
              </div>
          </div>
          <div class="row mt-2">
                <div class="col-md-6">
                  <label class="form-label">Name</label>
                  <input type="text" class="form-control" name="name" placeholder="Please Name" maxlength="120">
                  <span class="form-text">{{ form.name.help_text|safe }}</span><br>
                  {% for error in form.name.errors %}
                     <span class="text-danger ml-2">{{ error|safe }}</span><br>
                  {% endfor %}
                </div>
              <div class="col col-6">
                  <label class="form-label">Subject</label>
                  <input type="text" class="form-control" name="subject" placeholder="Please Subject" maxlength="120">
                  <span class="form-text">{{ form.subject.help_text|safe }}</span><br>
                  {% for error in form.subject.errors %}
                    <span class="text-danger ml-2">{{ error|safe }}</span><br>
                  {% endfor %}
              </div>
          </div>
          <div class="row mt-2">
              <div class="col col-6">
                  <label class="form-label">Count</label>
                  <input type="number" class="form-control" name="count" placeholder="Please Count">
                  <span class="form-text">{{ form.count.help_text|safe }}</span><br>
                  {% for error in form.count.errors %}
                    <span class="text-danger ml-2">{{ error|safe }}</span><br>
                  {% endfor %}
              </div>
              <div class="col col-6">
                  <label class="form-label">Page Count</label>
                  <input type="text" class="form-control" name="page_count" placeholder="Please Page Count">
                  <span class="form-text">{{ form.page_count.help_text|safe }}</span><br>
                  {% for error in form.page_count.errors %}
                    <span class="text-danger ml-2">{{ error|safe }}</span><br>
                  {% endfor %}
              </div>
          </div>
          <div class="row mt-2">
              <div class="col col-6">
                  <label class="form-label">ISBN</label>
                  <input type="text" class="form-control" name="isbn" placeholder="Please ISBN">
                  <span class="form-text">{{ form.isbn.help_text|safe }}</span><br>
                  {% for error in form.isbn.errors %}
                    <span class="text-danger ml-2">{{ error|safe }}</span><br>
                  {% endfor %}
              </div>
              <div class="col col-6">
                  <label class="form-label">Publisher Date</label>
                  <input type="date" class="form-control" name="publisher_date">
                  <span class="form-text">{{ form.publisher_date.help_text|safe }}</span><br>
                  {% for error in form.publisher_date.errors %}
                    <span class="text-danger ml-2">{{ error|safe }}</span><br>
                  {% endfor %}
              </div>
          </div>
          <div class="row mt-2">
              <div class="col col-12">
                  <label class="form-label">Description</label>
                  <div>{{form.description}}</div>
                  <span class="form-text">{{ form.description.help_text|safe }}</span><br>
                  {% for error in form.description.errors %}
                    <span class="text-danger ml-2">{{ error|safe }}</span><br>
                  {% endfor %}
              </div>
          </div>
          <div class="container d-flex justify-content-center">
              <button class="btn btn-success me-2" type="submit">Save</button>
              <button type="button" class="btn btn-secondary close-modal" data-bs-dismiss="modal">Close</button>
          </div>
      </div>
    </form>
</div>

<script type="text/javascript">
    function get_writers() {
       id = document.getElementById("publisher_id").value;
       $.ajax({
        type: "GET",
        url:  "{% url 'publisher_of_writers' %}",
        data: {'publisher_id': id},
        success: function(data) {
                let html_data = '<option value="">---------</option>';
                data.forEach(function (writer) {
                    html_data += `<option value="${writer.id}">${writer.name}</option>`
                });
                $("#writer_id").html(html_data);
        },
        error: function() {
            alert('Error occurred');
        }
       });
    }
</script>

{% endblock %}
